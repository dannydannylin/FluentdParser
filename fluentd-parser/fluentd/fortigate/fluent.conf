
#################### source section ####################

<source>
  @type tail
  path /var/log/Firewall_CEF.log
  #pos_file /var/log/auth_log.pos
  tag auth
  <parse>
    @type none
  </parse>
</source>

#################### rewrite tag ####################

<match auth>
  @type rewrite_tag_filter
  ####### fortigate.cfg #######

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)\s+(?:devname="?(?<devname>[^"\s]+)"?\s+|devid="?(?<devid>[^\s"]+)"?\s+|log_?id="?\d{4}(?<msgid>[^"\s]+)"?\s+|tye="?(?<tye>[^"\s]+)"?\s+|subtye="?(?<subtye>[^"\s]+)"?\s+|eventtye="?(?<eventtye>[^"\s]+)"?\s+|eventtime=\S+\s+|level="?(?<level>[^"\s]+)"?\s+|(?:status|arisk)=(?<status_or_arisk>\S+)\s+|vd="?(?<vd>[^",\s]+)"?\s+|severity=\S+\s+|(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?\s+|(?:src_?ort|remort)=(?<srcort>\S+)\s+|(?:outintf|srcintf)="(?<srcintf>[^"]+)"\s+|(?:outintfrole|srcintfrole)="[^"]+"\s+|direction=\S+\s+|(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)\s+|(?:dst_?ort|locort)=(?<dstort>\S+)\s+|dstintf="(?<dstintf>[^"]+)"|srccountry="[^"]+"\s+|sessionid=\S+\s+|action="?(?<action>[^"\s]+)"?\s+|roto=(?<roto>\S+)\s+|service="?(?<service>[^"\s]+)"?\s+|count=\S+\s+|attack=\S+\s+)+attackid=(?<attack_id>\d{8,})\s+(?:user="(?<user>[^"]+)"|(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|msg="(?<msg>[^"]+)"\s+|[^=]+=(?:"[^"]+"\s*|\S+)\s*)*/
    tag my.for1
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname=(?<devname>\S+)|\s+devid="?(?<devid>[^\s"]+)"?|\s+log_?id=\d{4}(?<msgid>\S+)|\s+tye=(?<tye>\S+)|\s+subtye=(?<subtye>\S+)|\s+eventtye=(?<eventtye>\S+)|\s+level=(?<level>\S+)|\s+(?:status|arisk)=(?<status_or_arisk>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s*olicyid=(?<olicy_id>\d+)|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\s*attackid=(?<attack_id>\d+)|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for2
  </rule>

  <rule>
    key message
    pattern /^(?<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?<device>\S+)(?:\s+date=\S+\s+time=\S+\s+)?\s*devname="?(?<devname>[^\s+"]+)"?\s+devid="?(?<devid>[^\s+"]+)"?\s+logid="01000(?<msgid>44547|44545)"(?:\s+tye="?(?<tye>[^\s+"]+)"?|\s+subtye="?(?<subtye>[^\s+"]+)"?|\s+eventtye="?(?<eventtye>[^\s+"]+)"?|\s+level="?(?<level>[^\s+"]+)"?|\s+status="?(?<status>[^\s+"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:src_i|srci|src|remi)=(?<srci>\S+)|\s+(?:remort|src_?ort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:loci|dst_i|dsti|dst)=(?<dsti>\S+)|\s+(?:locort|dst_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="(?<service>[^"]+)"|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+cfgath="(?<cfgath>[^"]+)"|\s+cfgobj="(?<cfgobj>[^"]+)"|\s+cfgattr="(?<cfgattr>[^"]+)"|\s+logdesc="(?<logdesc>[^"]+)"|\s+ui="(?<ui_tye>[^"]\w\w)\((?<ui>[^"]+)\)"|\s+ui="(?<ha_daemon>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for3
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)\s+logver=\d+\s+devname="?(?<devname>[^\s"]+)"?\s+devid="?(?<devid>[^\s"]+)"?\s+logid="(?<msgid>\d{1,5})"\s+tye="?(?<tye>[^"\s]+)"?(?:\s+subtye="?(?<subtye>[^"\s]+)"?|\s+level="?(?<level>[^"\s]+)"?|\s+(?:status|arisk)="?(?<status_or_arisk>[^"\s]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+logdesc="?(?<logdesc>[^"]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for4
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+devid="?(?<devid>[^\s"]+)"?|\s+log_?id=\d{4}(?<msgid>\S+)|\s+tye=(?<tye>\S+)|\s+subtye=(?<subtye>\S+)|\s+eventtye=(?<eventtye>\S+)|\s+level=(?<level>\S+)|\s+(?:status|arisk)=(?<status_or_arisk>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+srcmac=(?<srcmac>\S+)|\s(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\sdevtye="(?<devtye>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for5
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+devid="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^"\s]+)"?|\s+tye="?(?<tye>[^"\s]+)"?|\s+subtye="?(?<subtye>[^"\s]+)"?|\s+eventtye=(?<eventtye>\S+)|\s+level="?(?<level>[^"\s]+)"?|\s+(?:status|arisk)=(?<status_or_arisk>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for6
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?=.*?tye=traffic)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+devid="?(?<devid>[^\s"]+)"?|\s+log_?id=\d{4}(?<msgid>\S+)|\s+tye=(?<tye>\S+)|\s+subtye=(?<subtye>\S+)|\s+eventtye=(?<eventtye>\S+)|\s+level=(?<level>\S+)|\s+status=(?<status>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+a="?(?<a>[^"\s]+)"?|\s+devtye="?(?<devtye>[^"]+)"?|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+srcmac=(?<srcmac>\S+)|\svntunnel="(?<vn_tunnel>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for7
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)\s+(?:devname="?(?<devname>[^\s"]+)"?\s*|(?:devid|device_id)="?(?<devid>[^\s"]+)"?\s*|log_?id="?\d{4}(?<msgid>028704)"?\s*|tye="?(?<tye>[^\s"]+)"?\s*|subtye="?(?<subtye>[^\s"]+)"?\s*|eventtye="?(?<eventtye>[^"\s]+)"?\s*|level="?(?<level>[^\s"]+)"?\s*|(?:status|arisk)="?(?<status_or_arisk>[^\s"]+)"?\s*|vd="?(?<vd>[^",\s]+)"?\s*|user="?(?<user>[^",\s]+)"?\s*|(?:i="?|src_i=|srci=|src=|rem_?i=|ui=(?:ssh\(|htts\()?)(?<srci>[^)\s"]+)\)?"?\s*|(?:src_?ort|rem_?ort)=(?<srcort>\S+)\s*|(?:out_?intf|srcintf)="(?<srcintf>[^"]+)"\s*|(?:dst_i|dsti|dst|loc_?i)=(?<dsti>(?:(?!N/A)\S+))\s*|(?:dst_?ort|loc_?ort)=(?<dstort>\S+)\s*|dstintf="(?<dstintf>[^"]+)"\s*|roto=(?<roto>\S+)\s*|alist="?(?<alist>[^"]+)"?\s*|a="?(?<a>[^"]+)"?\s*|action="?(?<action>[^"\s]+)"?\s*|service="?(?<service>[^",\s]+)"?\s*|hostname="?(?<hostname>[^"\s]+)"?\s*|url="?(?<url>[^"\s]+)"?\s*|msg="(?<msg>[^"]+)"\s*|(?:vn_?tunnel|acat)="(?<vn_tunnel_or_acat>[^"]+)"\s*|[^=]+=(?:"[^"]+"|\S+)\s*)+/
    tag my.for8
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)\sdevname="(?<devname>[^"]+)"\s+devid="(?<devid>[^"]+)"\s+logid="\d{4}(?<msgid>[^\s"]+)"\stye="(?<tye>utm)"\ssubtye="(?<subtye>[^"]+)"\seventtye="(?<eventtye>[^"]+)"\slevel="(?<level>[^"]+)"\svd="(?<vd>[^"]+)"\seventtime=\S+\s(?:olicyid=\d+\s|sessionid=\d+\s|aid=\d+\s+|srci=(?<srci>\S+)\s|srcort=(?<srcort>\d+)\s|srcintf="(?<srcintf>[^"]+)"\s|srcintfrole="[^"]+"\s|dsti=(?<dsti>\S+)\s|dstort=(?<dstort>\d+)\s|dstintf="(?<dstintf>[^"]+)"\s|dstintfrole="[^"]+"\s|roto=(?<roto>\d+)\s|service="[^"]+"\s|hostname="(?<hostname>[^"]+)"\s|rofile="[^"]+"\s|action="(?<action>[^"]+)"\s|reqtye="[^"]+"\s|url="(?<url>[^"]+)"\s|sentbyte=\d+\s|rcvdbyte=\d+\s|direction="[^"]+"\s|msg="(?<msg>[^"]+)"\s|\w+="[^"]+"\s+|\w+=\d+\s+)*+/
    tag my.for9
  </rule>

  <rule>
    key message
    pattern /^(?<syslog_date>\S+\s\d+\s\d+:\d+:\d+)\s(?<src_i>\d+\.\d+\.\d+\.\d+)\s(?:\s*subject=[^:]+:(?<sid>\S+(?:(?!\s\w+=)\s\S+)*)\sdevice=(?<device>\S+(?:(?!\s\w+=)\s\S+)*)\sseverity=(?<sev>\S+)\sfrom=(?<from>\S+(?:(?!\s\w+=)\s\S+)*)\strigger=(?<trigger>\S+(?:(?!\s\w+=)\s\S+)*)\sfilter=(?<filter>\S+)?\slog=")?(?:\s*log_?id=(?<log_id>\S+)|\s*logver=(?<logver>\S+)|\s*timestam=(?<timestam>\S+)|\stye=(?<tye>(?:\S+))|\ssubtye=(?<subtye>\S+)|\sri=(?<ri>\S+)|\s(?:log)?desc="(?<desc>[^"]+)"|\suser="?(?<user>[^\s"]+)"?|\suserfrom="?(?<userfrom>[^\s"]+)"?|\smsg="(?<msg>[^"]+)"|\saction=(?<action>\S+)|\sadminrof="(?<adminrof>[^"]*)"|\sdevid=(?<devid>\S+)|\s*itime=(?<itime>\S+)|\sdate=(?<date>\S+)|\stime=(?<time>\S+)|\sidseq=(?<ideseq>\S+)|\sdevname=(?<devname>\S+)|\svd=(?<vd>\S+)|\slevel="(?<level>[^"]+)"|\seventtime=(?<eventtime>\S+)|\stz="(?<tz>[^"]+)"|\ssn="(?<sn>[^"]+)"|\sui="(?<ui>[^"]+)"|\smethod="(?<method>[^"]+)"|\ssrci=(?<srci>\d+\.\d+\.\d+\.\d+)|\sdsti=(?<dsti>\d+\.\d+\.\d+\.\d+)|\sstatus="(?<status>[^"]+)"|\sreason="(?<reason>[^"]+)"|\srofile="(?<rofile>[^"]+)")+/
    tag my.for10
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>040704)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>[^\s"]+)"?|\s+eventtye=(?<eventtye>\S+)|\s+level="?(?<level>[^\s"]+)"?|\s+(?:status|arisk)="?(?<status_or_arisk>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|rem_?i=|ui=(?:ssh\(|htts\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|rem_?ort)=(?<srcort>\S+)|\s+(?:out_?intf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loc_?i)=(?<dsti>(?:(?!N/A)\S+))|\s+(?:dst_?ort|loc_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+cu=(?<cu>\d+)|\s+mem=(?<mem>\d+)|\s+totalsession=(?<session>\S+)|\s+disk=(?<disk>\S+)|\s+bandwidth=(?<bandwidth>\S+)|\s+a="?(?<a>[^"]+)"?|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="?(?<hostname>[^"\s]+)"?|\s+url="?(?<url>[^"\s]+)"?|\s+msg="(?<msg>[^"]+)"|\s(?:vn_?tunnel|acat)="(?<vn_tunnel_or_acat>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for11
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+(?:devid|device_id)=(?<devid>\S+)|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>[^\s"]+)"?|\s+eventtye=(?<eventtye>\S+)|\s+level="?(?<level>[^\s"]+)"?|\s+(?:status|arisk)="?(?<status_or_arisk>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+a="(?<a>[^"]*)"|\s+va="(?<va>[^"]*)"|\s+(?:i="?|src_i=|srci=|src=|rem_?i=|ui=(?:ssh\(|htts\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|rem_?ort)=(?<srcort>\S+)|\s+(?:out_?intf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loc_?i)=(?<dsti>(?:(?!N/A)\S+))|\s+(?:dst_?ort|loc_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="?(?<hostname>[^"\s]+)"?|\s+url="?(?<url>[^"\s]+)"?|\s+user="?(?<user>[^"\s]+)"?|\s+server=(?<server>\S+)|\s+result=(?<result>\S+)|\s+channel=(?<ch>\d+)|\s+radioband="(?<band>[^"]*)"|\s+security="(?<sec>[^"]*)"|\s+encrytion="(?<enc>[^"]*)"|\s+reason="(?<reason>[^"]*)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+srcmac="?(?<srcmac>[^"\s]+)"?|\s(?:vn_?tunnel|acat)="(?<vn_tunnel_or_acat>[^"]+)"|\stunnel_i=(?<tunnel_i>\S+)|\sgrou="?(?<grou>[^"\s]+)"?|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\sseverity=(?<severity>\S+)|\sattack="(?<attack>[^"]+)"|\sattackid=(?<attack_id>\S+)|\scrscore=(?<client_risk_score>\S+)|\s*file="(?<filename>[^"]+)"|\s*qname="(?<qname>[^"]+)"|\s*qtye="(?<qtye>[^"]+)"|\s*iaddr="(?<iaddr>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for12
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^"\s]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>[^\s"]+)"?|\s+level="?(?<level>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+logdesc="?(?<logdesc>[^"]+)"?|\s+user="?(?<user>[^"\s]+)"?|\s+ui="?(?<ui>[^"\s]+)"?|\s+action="?(?<action>[^"\s]+)"?|\s+cfgattr="(?<cfgattr>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for13
  </rule>
  
  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^"\s]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>vn)"?|\s+level="?(?<level>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+eventtime="?(?<eventtime>\S+)|\s+tz="(?<tz>[^"]+)"|\s+logdesc="(?<logdesc>[^"]+)"|\s+action="?(?<action>[^"]+)"?|\s+tunneltye="?(?<tunnel_tye>[^"]+)"?|\s+tunnelid="?(?<tunnel_id>\d+)"?|\s+remi="?(?<remi>\S+)"?|\s+tunneli="?(?<tunnel_i>\S+)"?|\s+user="?(?<user>[^"]+)"?|\s+grou="?(?<grou>[^"]+)"?|\s+dst_host="?(?<dst_host>[^"]+)"?|\s+nextstat=\d+|\s+duration=\d+|\s+sentbyte=(?<sent>\d+)|\s+rcvdbyte=(?<rcvd>\d+)|\s+reason="(?<reason>[^"]+)"|\s+msg="(?<msg>[^"]+)")+/
    tag my.for14
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^"\s]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>system)"?|\s+level="?(?<level>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+eventtime="?(?<eventtime>\S+)|\s+logdesc="(?<logdesc>[^"]+)"|\s+action="?(?<action>[^"]+)"?|\s+user="?(?<user>[^"]+)"?|\s+ui="?(?<ui>[^"]+)"?|\s+status="?(?<status>[^"]+)"?|\s+count=\d+|\s+msg="(?<msg>Failed to send alert email from (?<src_i>\S+)\s+to \((?<mail>\S+)\s*\))")+/
    tag my.for15
  </rule>

  <rule>
    key message
    pattern /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^"\s]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>[^\s"]+)"?|\s+eventtye=(?<eventtye>\S+)|\s+level="?(?<level>[^\s"]+)"?|\s+(?:status|arisk)="?(?<status_or_arisk>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+a="(?<a>[^"]*)"|\s+va="(?<va>[^"]*)"|\s+(?:i="?|src_i=|srci="?|src=|rem_?i=|ui="?(?:ssh\(|htts\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|rem_?ort)=(?<srcort>\S+)|\s+(?:out_?intf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loc_?i|server)="?(?<dsti>(?:(?!N/A)[^\s"]+))"?|\s+(?:dst_?ort|loc_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"\s]+)"?|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="?(?<hostname>[^"\s]+)"?|\s+url="?(?<url>[^"\s]+)"?|\s+user="?(?<user>[^"\s]+)"?|\s+result=(?<result>\S+)|\s+channel=(?<ch>\d+)|\s+radioband="(?<band>[^"]*)"|\s+security="(?<sec>[^"]*)"|\s+encrytion="(?<enc>[^"]*)"|\s+reason="(?<reason>[^"]*)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+srcmac="?(?<srcmac>[^"\s]+)"?|\s(?:vn_?tunnel|acat)="(?<vn_tunnel_or_acat>[^"]+)"|\stunnel_i=(?<tunnel_i>\S+)|\sgrou="?(?<grou>[^"\s]+)"?|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\sseverity=(?<severity>\S+)|\sattack="(?<attack>[^"]+)"|\sattackid=(?<attack_id>\S+)|\scrscore=(?<client_risk_score>\S+)|\s*file="(?<filename>[^"]+)"|\s+[^=]+=(?:\S+(?:(?!\s\w+=)\s\S+)*))+/
    tag my.for16
  </rule>

  <rule>
    key message
    pattern /^(?<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?<device>\S+)\s+date=\d+-\d+-\d+,time=\d+:\s*\d+:\d+(?:,devname="?(?<devname>[^",]+)"?|,devid="?(?<devid>[^",]+)"?|,log_?id="?\d{4}(?<msgid>[^,"]+)"?|,tye="?(?<tye>[^,"]+)"?|,subtye="?(?<subtye>[^,"]+)"?|,eventtye="?(?<eventtye>[^,"]+)"?|,level="?(?<level>[^,"]+)"?|,status="?(?<status>[^,"]+)"?|,vd="?(?<vd>[^",\s]+)"?|,(?:src_i|srci|src|remi)="?(?<srci>[^,"]+)"?|,src_?ort="?(?<srcort>[^,"]+)"?|,srcintf="(?<srcintf>[^"]+)"|,(?:dst_i|dsti|dst)="?(?<dsti>[^,"]+)"?|,dst_?ort="?(?<dstort>[^,"]+)"?|,dstintf="(?<dstintf>[^"]+)"|,roto="?(?<roto>[^,"]+)"?|,action="?(?<action>[^,"]+)"?|,service="?(?<service>[^",\s]+)"?|,hostname="?(?<hostname>[^",]+)"?|,url="?(?<url>[^",]+)"?|,user="?(?<user>[^",]+)"?|,msg="?(?<msg>[^",]+)"?|,(?:(?!attack|=|"|,).)*?attack(?:(?!=|").)*?="(?<attack>[^",]+)"|,ri="(?<ri>[^,"]+)"?|,[^=]+=(?:"[^"]+"|[^,]+))+/
    tag my.for17
  </rule>

  <rule>
    key message
    pattern /^(?<date>\w{3}\s+\d{1,2}\s+\d{2}:\d{2}:\d{2})\s+(?<device>\S+)\sCEF:\s\d+\|Fortinet\|Fortigate\|(?<version>[^\|]*)\|(?<sign_id>[^|]*)\|(?<event_name>[^\|]*)\|(?<devid>\d+)\|FTNTFGTlogid=\d{3}[^01]?(?<msgid>\S+)\s+cat=(?<category>\S+)\s+FTNTFGTsubtye=(?<subtye>\S+)\s+(?:FTNTFGTlevel=(?<level>\S+)\s+|FTNTFGTvd=(?<vd>\S+)\s+|src=(?<srci>\S+)\s+|shost=(?<hostname>\S+)\s+|st=(?<srcort>\S+)\s+|deviceInboundInterface=(?<srcintf>\S+)\s+|dst=(?<dsti>\S+)\s+|dt=(?<dstort>\S+)\s+|deviceOutboundInterface=(?<dstintf>\S+)\s+|externalId=(?<external_id>\S+)\s+|roto=(?<roto>\S+)\s+|act=(?<action>\S+)\s+|FTNTFGTolicyid=(?<olicy_id>\S+)\s+|FTNTFGTolicytye=(?<olicy_tye>[^\s]*)\s*|FTNTFGTdstcountry=(?<dst_country>(?:(?!\w+=)\S+\s*)*)\s+|FTNTFGTsrccountry=(?<src_country>\S+)\s+|FTNTFGTtrandis=(?<transdis>\S+)\s+|a=(?<alication_ort>\S+)\s+|FTNTFGTa=(?<alication>(?:(?!\w+=)\S+\s*)*)\s+|FTNTFGTduration=(?<duration>\S+)\s+|out=\S+\s|in=\S+\s+|FTNTFGTsentkt=(?<sent_kt>\S+)\s+|FTNTFGTacat=(?<a_cat>\S+)\s|FTNTFGTcrscore=(?<cr_score>\S+)\s|FTNTFGTcraction=(?<cr_action>\S+)\s|FTNTFGTcrlevel=(?<cr_level>\S+)\s|FTNTFGTdevtye=(?<dev_tye>(?:(?!\w+=)\S+\s*)*)\s+|FTNTFGTosname=(?<os_name>(?:(?!\w+=)\S+\s*)*)\s|FTNTFGTosversion=(?<os_version>\S+)\s|FTNTFGTmastersrcmac=(?<master_src_mac>\S+)\s|FTNTFGTsrcmac=(?<src_mac>\S+)\s|FTNTFGTsrcserver=(?<src_server>\S+)|FTNTFGTeventtye=\S+\s*|FTNTFGToluuid=\S+\s*|dhost=(?<dst_hostname>\S+)\s*|FTNTFGTrofile=\S+\s*|\w+=(?:(?!\w+=)\S+\s*)*\s*)+/
    tag my.for18
  </rule>

  <rule>
    key message
    pattern /^(?<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?<device>\S+)\s+(?:date=\d+\[\d+\]\d+ time=\d+:\d+:\d+\s+|devname="?(?<devname>[^\s"]+)"?\s+|devid="?(?<devid>[^\s"]+)"?\s+|deviceid=\S+\s+)+\s*log_?id=\d{4}(?<msgid>\S+)\s*(?:tye=(?<tye>\S+)|\s+subtye=(?<subtye>\S+)|\s+eventtye=(?<eventtye>\S+)|\s+level=(?<level>\S+)|\s+status=(?<status>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:src_i|srci|src|remi)=(?<srci>\S+)|\s+(?:remort|src_?ort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:loci|dst_i|dsti|dst)=(?<dsti>\S+)|\s+(?:locort|dst_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action=(?<action>\S+)|\s+service="(?<service>[^"]+)"|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+[^=]+=(?:"[^"]+"|\S+))+/
    tag my.for19
  </rule>

  <rule>
    key message
    pattern /^(?<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?<device>\S+).*/
    tag my.for20
  </rule>

  <rule>
    key message
    pattern /^(?<all>.*)/
    tag my.for100
  </rule>

  
</match>

#################### parser ####################

####### fortigate #######

<filter my.for1>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)\s+(?:devname="?(?<devname>[^"\s]+)"?\s+|devid="?(?<devid>[^\s"]+)"?\s+|log_?id="?\d{4}(?<msgid>[^"\s]+)"?\s+|tye="?(?<tye>[^"\s]+)"?\s+|subtye="?(?<subtye>[^"\s]+)"?\s+|eventtye="?(?<eventtye>[^"\s]+)"?\s+|eventtime=\S+\s+|level="?(?<level>[^"\s]+)"?\s+|(?:status|arisk)=(?<status_or_arisk>\S+)\s+|vd="?(?<vd>[^",\s]+)"?\s+|severity=\S+\s+|(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?\s+|(?:src_?ort|remort)=(?<srcort>\S+)\s+|(?:outintf|srcintf)="(?<srcintf>[^"]+)"\s+|(?:outintfrole|srcintfrole)="[^"]+"\s+|direction=\S+\s+|(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)\s+|(?:dst_?ort|locort)=(?<dstort>\S+)\s+|dstintf="(?<dstintf>[^"]+)"|srccountry="[^"]+"\s+|sessionid=\S+\s+|action="?(?<action>[^"\s]+)"?\s+|roto=(?<roto>\S+)\s+|service="?(?<service>[^"\s]+)"?\s+|count=\S+\s+|attack=\S+\s+)+attackid=(?<attack_id>\d{8,})\s+(?:user="(?<user>[^"]+)"|(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|msg="(?<msg>[^"]+)"\s+|[^=]+=(?:"[^"]+"\s*|\S+)\s*)*/
  </parse>
</filter>

<filter my.for2>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname=(?<devname>\S+)|\s+devid="?(?<devid>[^\s"]+)"?|\s+log_?id=\d{4}(?<msgid>\S+)|\s+tye=(?<tye>\S+)|\s+subtye=(?<subtye>\S+)|\s+eventtye=(?<eventtye>\S+)|\s+level=(?<level>\S+)|\s+(?:status|arisk)=(?<status_or_arisk>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s*olicyid=(?<olicy_id>\d+)|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\s*attackid=(?<attack_id>\d+)|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for3>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^(?<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?<device>\S+)(?:\s+date=\S+\s+time=\S+\s+)?\s*devname="?(?<devname>[^\s+"]+)"?\s+devid="?(?<devid>[^\s+"]+)"?\s+logid="01000(?<msgid>44547|44545)"(?:\s+tye="?(?<tye>[^\s+"]+)"?|\s+subtye="?(?<subtye>[^\s+"]+)"?|\s+eventtye="?(?<eventtye>[^\s+"]+)"?|\s+level="?(?<level>[^\s+"]+)"?|\s+status="?(?<status>[^\s+"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:src_i|srci|src|remi)=(?<srci>\S+)|\s+(?:remort|src_?ort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:loci|dst_i|dsti|dst)=(?<dsti>\S+)|\s+(?:locort|dst_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="(?<service>[^"]+)"|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+cfgath="(?<cfgath>[^"]+)"|\s+cfgobj="(?<cfgobj>[^"]+)"|\s+cfgattr="(?<cfgattr>[^"]+)"|\s+logdesc="(?<logdesc>[^"]+)"|\s+ui="(?<ui_tye>[^"]\w\w)\((?<ui>[^"]+)\)"|\s+ui="(?<ha_daemon>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for4>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)\s+logver=\d+\s+devname="?(?<devname>[^\s"]+)"?\s+devid="?(?<devid>[^\s"]+)"?\s+logid="(?<msgid>\d{1,5})"\s+tye="?(?<tye>[^"\s]+)"?(?:\s+subtye="?(?<subtye>[^"\s]+)"?|\s+level="?(?<level>[^"\s]+)"?|\s+(?:status|arisk)="?(?<status_or_arisk>[^"\s]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+logdesc="?(?<logdesc>[^"]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for5>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+devid="?(?<devid>[^\s"]+)"?|\s+log_?id=\d{4}(?<msgid>\S+)|\s+tye=(?<tye>\S+)|\s+subtye=(?<subtye>\S+)|\s+eventtye=(?<eventtye>\S+)|\s+level=(?<level>\S+)|\s+(?:status|arisk)=(?<status_or_arisk>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+srcmac=(?<srcmac>\S+)|\s(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\sdevtye="(?<devtye>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for6>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+devid="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^"\s]+)"?|\s+tye="?(?<tye>[^"\s]+)"?|\s+subtye="?(?<subtye>[^"\s]+)"?|\s+eventtye=(?<eventtye>\S+)|\s+level="?(?<level>[^"\s]+)"?|\s+(?:status|arisk)=(?<status_or_arisk>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s(?:vntunnel|acat)="(?<vn_tunnel_or_a_cat>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for7>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?=.*?tye=traffic)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+devid="?(?<devid>[^\s"]+)"?|\s+log_?id=\d{4}(?<msgid>\S+)|\s+tye=(?<tye>\S+)|\s+subtye=(?<subtye>\S+)|\s+eventtye=(?<eventtye>\S+)|\s+level=(?<level>\S+)|\s+status=(?<status>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|remi=|ui=(?:ssh\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|remort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loci)=(?<dsti>\S+)|\s+(?:dst_?ort|locort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+a="?(?<a>[^"\s]+)"?|\s+devtye="?(?<devtye>[^"]+)"?|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+srcmac=(?<srcmac>\S+)|\svntunnel="(?<vn_tunnel>[^"]+)"|\sgrou="(?<grou>[^"]+)"|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for8>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)\s+(?:devname="?(?<devname>[^\s"]+)"?\s*|(?:devid|device_id)="?(?<devid>[^\s"]+)"?\s*|log_?id="?\d{4}(?<msgid>028704)"?\s*|tye="?(?<tye>[^\s"]+)"?\s*|subtye="?(?<subtye>[^\s"]+)"?\s*|eventtye="?(?<eventtye>[^"\s]+)"?\s*|level="?(?<level>[^\s"]+)"?\s*|(?:status|arisk)="?(?<status_or_arisk>[^\s"]+)"?\s*|vd="?(?<vd>[^",\s]+)"?\s*|user="?(?<user>[^",\s]+)"?\s*|(?:i="?|src_i=|srci=|src=|rem_?i=|ui=(?:ssh\(|htts\()?)(?<srci>[^)\s"]+)\)?"?\s*|(?:src_?ort|rem_?ort)=(?<srcort>\S+)\s*|(?:out_?intf|srcintf)="(?<srcintf>[^"]+)"\s*|(?:dst_i|dsti|dst|loc_?i)=(?<dsti>(?:(?!N/A)\S+))\s*|(?:dst_?ort|loc_?ort)=(?<dstort>\S+)\s*|dstintf="(?<dstintf>[^"]+)"\s*|roto=(?<roto>\S+)\s*|alist="?(?<alist>[^"]+)"?\s*|a="?(?<a>[^"]+)"?\s*|action="?(?<action>[^"\s]+)"?\s*|service="?(?<service>[^",\s]+)"?\s*|hostname="?(?<hostname>[^"\s]+)"?\s*|url="?(?<url>[^"\s]+)"?\s*|msg="(?<msg>[^"]+)"\s*|(?:vn_?tunnel|acat)="(?<vn_tunnel_or_acat>[^"]+)"\s*|[^=]+=(?:"[^"]+"|\S+)\s*)+/
  </parse>
</filter>

<filter my.for9>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)\sdevname="(?<devname>[^"]+)"\s+devid="(?<devid>[^"]+)"\s+logid="\d{4}(?<msgid>[^\s"]+)"\stye="(?<tye>utm)"\ssubtye="(?<subtye>[^"]+)"\seventtye="(?<eventtye>[^"]+)"\slevel="(?<level>[^"]+)"\svd="(?<vd>[^"]+)"\seventtime=\S+\s(?:olicyid=\d+\s|sessionid=\d+\s|aid=\d+\s+|srci=(?<srci>\S+)\s|srcort=(?<srcort>\d+)\s|srcintf="(?<srcintf>[^"]+)"\s|srcintfrole="[^"]+"\s|dsti=(?<dsti>\S+)\s|dstort=(?<dstort>\d+)\s|dstintf="(?<dstintf>[^"]+)"\s|dstintfrole="[^"]+"\s|roto=(?<roto>\d+)\s|service="[^"]+"\s|hostname="(?<hostname>[^"]+)"\s|rofile="[^"]+"\s|action="(?<action>[^"]+)"\s|reqtye="[^"]+"\s|url="(?<url>[^"]+)"\s|sentbyte=\d+\s|rcvdbyte=\d+\s|direction="[^"]+"\s|msg="(?<msg>[^"]+)"\s|\w+="[^"]+"\s+|\w+=\d+\s+)*/
  </parse>
</filter>

<filter my.for10>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^(?<syslog_date>\S+\s\d+\s\d+:\d+:\d+)\s(?<src_i>\d+\.\d+\.\d+\.\d+)\s(?:\s*subject=[^:]+:(?<sid>\S+(?:(?!\s\w+=)\s\S+)*)\sdevice=(?<device>\S+(?:(?!\s\w+=)\s\S+)*)\sseverity=(?<sev>\S+)\sfrom=(?<from>\S+(?:(?!\s\w+=)\s\S+)*)\strigger=(?<trigger>\S+(?:(?!\s\w+=)\s\S+)*)\sfilter=(?<filter>\S+)?\slog=")?(?:\s*log_?id=(?<log_id>\S+)|\s*logver=(?<logver>\S+)|\s*timestam=(?<timestam>\S+)|\stye=(?<tye>(?:\S+))|\ssubtye=(?<subtye>\S+)|\sri=(?<ri>\S+)|\s(?:log)?desc="(?<desc>[^"]+)"|\suser="?(?<user>[^\s"]+)"?|\suserfrom="?(?<userfrom>[^\s"]+)"?|\smsg="(?<msg>[^"]+)"|\saction=(?<action>\S+)|\sadminrof="(?<adminrof>[^"]*)"|\sdevid=(?<devid>\S+)|\s*itime=(?<itime>\S+)|\sdate=(?<date>\S+)|\stime=(?<time>\S+)|\sidseq=(?<ideseq>\S+)|\sdevname=(?<devname>\S+)|\svd=(?<vd>\S+)|\slevel="(?<level>[^"]+)"|\seventtime=(?<eventtime>\S+)|\stz="(?<tz>[^"]+)"|\ssn="(?<sn>[^"]+)"|\sui="(?<ui>[^"]+)"|\smethod="(?<method>[^"]+)"|\ssrci=(?<srci>\d+\.\d+\.\d+\.\d+)|\sdsti=(?<dsti>\d+\.\d+\.\d+\.\d+)|\sstatus="(?<status>[^"]+)"|\sreason="(?<reason>[^"]+)"|\srofile="(?<rofile>[^"]+)")+/
  </parse>
</filter>

<filter my.for11>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>040704)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>[^\s"]+)"?|\s+eventtye=(?<eventtye>\S+)|\s+level="?(?<level>[^\s"]+)"?|\s+(?:status|arisk)="?(?<status_or_arisk>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:i="?|src_i=|srci=|src=|rem_?i=|ui=(?:ssh\(|htts\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|rem_?ort)=(?<srcort>\S+)|\s+(?:out_?intf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loc_?i)=(?<dsti>(?:(?!N/A)\S+))|\s+(?:dst_?ort|loc_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+cu=(?<cu>\d+)|\s+mem=(?<mem>\d+)|\s+totalsession=(?<session>\S+)|\s+disk=(?<disk>\S+)|\s+bandwidth=(?<bandwidth>\S+)|\s+a="?(?<a>[^"]+)"?|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="?(?<hostname>[^"\s]+)"?|\s+url="?(?<url>[^"\s]+)"?|\s+msg="(?<msg>[^"]+)"|\s(?:vn_?tunnel|acat)="(?<vn_tunnel_or_acat>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for12>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^\s"]+)"?|\s+(?:devid|device_id)=(?<devid>\S+)|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>[^\s"]+)"?|\s+eventtye=(?<eventtye>\S+)|\s+level="?(?<level>[^\s"]+)"?|\s+(?:status|arisk)="?(?<status_or_arisk>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+a="(?<a>[^"]*)"|\s+va="(?<va>[^"]*)"|\s+(?:i="?|src_i=|srci=|src=|rem_?i=|ui=(?:ssh\(|htts\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|rem_?ort)=(?<srcort>\S+)|\s+(?:out_?intf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loc_?i)=(?<dsti>(?:(?!N/A)\S+))|\s+(?:dst_?ort|loc_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="?(?<hostname>[^"\s]+)"?|\s+url="?(?<url>[^"\s]+)"?|\s+user="?(?<user>[^"\s]+)"?|\s+server=(?<server>\S+)|\s+result=(?<result>\S+)|\s+channel=(?<ch>\d+)|\s+radioband="(?<band>[^"]*)"|\s+security="(?<sec>[^"]*)"|\s+encrytion="(?<enc>[^"]*)"|\s+reason="(?<reason>[^"]*)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+srcmac="?(?<srcmac>[^"\s]+)"?|\s(?:vn_?tunnel|acat)="(?<vn_tunnel_or_acat>[^"]+)"|\stunnel_i=(?<tunnel_i>\S+)|\sgrou="?(?<grou>[^"\s]+)"?|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\sseverity=(?<severity>\S+)|\sattack="(?<attack>[^"]+)"|\sattackid=(?<attack_id>\S+)|\scrscore=(?<client_risk_score>\S+)|\s*file="(?<filename>[^"]+)"|\s*qname="(?<qname>[^"]+)"|\s*qtye="(?<qtye>[^"]+)"|\s*iaddr="(?<iaddr>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for13>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^"\s]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>[^\s"]+)"?|\s+level="?(?<level>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+logdesc="?(?<logdesc>[^"]+)"?|\s+user="?(?<user>[^"\s]+)"?|\s+ui="?(?<ui>[^"\s]+)"?|\s+action="?(?<action>[^"\s]+)"?|\s+cfgattr="(?<cfgattr>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for14>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^"\s]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>vn)"?|\s+level="?(?<level>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+eventtime="?(?<eventtime>\S+)|\s+tz="(?<tz>[^"]+)"|\s+logdesc="(?<logdesc>[^"]+)"|\s+action="?(?<action>[^"]+)"?|\s+tunneltye="?(?<tunnel_tye>[^"]+)"?|\s+tunnelid="?(?<tunnel_id>\d+)"?|\s+remi="?(?<remi>\S+)"?|\s+tunneli="?(?<tunnel_i>\S+)"?|\s+user="?(?<user>[^"]+)"?|\s+grou="?(?<grou>[^"]+)"?|\s+dst_host="?(?<dst_host>[^"]+)"?|\s+nextstat=\d+|\s+duration=\d+|\s+sentbyte=(?<sent>\d+)|\s+rcvdbyte=(?<rcvd>\d+)|\s+reason="(?<reason>[^"]+)"|\s+msg="(?<msg>[^"]+)")+/
  </parse>
</filter>

<filter my.for15>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^"\s]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>system)"?|\s+level="?(?<level>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+eventtime="?(?<eventtime>\S+)|\s+logdesc="(?<logdesc>[^"]+)"|\s+action="?(?<action>[^"]+)"?|\s+user="?(?<user>[^"]+)"?|\s+ui="?(?<ui>[^"]+)"?|\s+status="?(?<status>[^"]+)"?|\s+count=\d+|\s+msg="(?<msg>Failed to send alert email from (?<src_i>\S+)\s+to \((?<mail>\S+)\s*\))")+/
  </parse>
</filter>

<filter my.for16>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^date=(?<date>\d+-\d+-\d+\stime=\d+:\d+:\d+)(?:\s+devname="?(?<devname>[^"\s]+)"?|\s+(?:devid|device_id)="?(?<devid>[^\s"]+)"?|\s+log_?id="?\d{4}(?<msgid>[^\s"]+)"?|\s+tye="?(?<tye>[^\s"]+)"?|\s+subtye="?(?<subtye>[^\s"]+)"?|\s+eventtye=(?<eventtye>\S+)|\s+level="?(?<level>[^\s"]+)"?|\s+(?:status|arisk)="?(?<status_or_arisk>[^\s"]+)"?|\s+vd="?(?<vd>[^",\s]+)"?|\s+a="(?<a>[^"]*)"|\s+va="(?<va>[^"]*)"|\s+(?:i="?|src_i=|srci="?|src=|rem_?i=|ui="?(?:ssh\(|htts\()?)(?<srci>[^)\s"]+)\)?"?|\s+(?:src_?ort|rem_?ort)=(?<srcort>\S+)|\s+(?:out_?intf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:dst_i|dsti|dst|loc_?i|server)="?(?<dsti>(?:(?!N/A)[^\s"]+))"?|\s+(?:dst_?ort|loc_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"\s]+)"?|\s+roto=(?<roto>\S+)|\s+action="?(?<action>[^"\s]+)"?|\s+service="?(?<service>[^",\s]+)"?|\s+hostname="?(?<hostname>[^"\s]+)"?|\s+url="?(?<url>[^"\s]+)"?|\s+user="?(?<user>[^"\s]+)"?|\s+result=(?<result>\S+)|\s+channel=(?<ch>\d+)|\s+radioband="(?<band>[^"]*)"|\s+security="(?<sec>[^"]*)"|\s+encrytion="(?<enc>[^"]*)"|\s+reason="(?<reason>[^"]*)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+srcmac="?(?<srcmac>[^"\s]+)"?|\s(?:vn_?tunnel|acat)="(?<vn_tunnel_or_acat>[^"]+)"|\stunnel_i=(?<tunnel_i>\S+)|\sgrou="?(?<grou>[^"\s]+)"?|\s*dstname="(?<dst_name>[^"]+)"|\sdst_host="(?<dst_host>[^"]+)"|\sseverity=(?<severity>\S+)|\sattack="(?<attack>[^"]+)"|\sattackid=(?<attack_id>\S+)|\scrscore=(?<client_risk_score>\S+)|\s*file="(?<filename>[^"]+)"|\s+[^=]+=(?:\S+(?:(?!\s\w+=)\s\S+)*))+/
  </parse>
</filter>

<filter my.for17>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^(?<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?<device>\S+)\s+date=\d+-\d+-\d+,time=\d+:\s*\d+:\d+(?:,devname="?(?<devname>[^",]+)"?|,devid="?(?<devid>[^",]+)"?|,log_?id="?\d{4}(?<msgid>[^,"]+)"?|,tye="?(?<tye>[^,"]+)"?|,subtye="?(?<subtye>[^,"]+)"?|,eventtye="?(?<eventtye>[^,"]+)"?|,level="?(?<level>[^,"]+)"?|,status="?(?<status>[^,"]+)"?|,vd="?(?<vd>[^",\s]+)"?|,(?:src_i|srci|src|remi)="?(?<srci>[^,"]+)"?|,src_?ort="?(?<srcort>[^,"]+)"?|,srcintf="(?<srcintf>[^"]+)"|,(?:dst_i|dsti|dst)="?(?<dsti>[^,"]+)"?|,dst_?ort="?(?<dstort>[^,"]+)"?|,dstintf="(?<dstintf>[^"]+)"|,roto="?(?<roto>[^,"]+)"?|,action="?(?<action>[^,"]+)"?|,service="?(?<service>[^",\s]+)"?|,hostname="?(?<hostname>[^",]+)"?|,url="?(?<url>[^",]+)"?|,user="?(?<user>[^",]+)"?|,msg="?(?<msg>[^",]+)"?|,(?:(?!attack|=|"|,).)*?attack(?:(?!=|").)*?="(?<attack>[^",]+)"|,ri="(?<ri>[^,"]+)"?|,[^=]+=(?:"[^"]+"|[^,]+))+/
  </parse>
</filter>

<filter my.for18>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^(?<date>\w{3}\s+\d{1,2}\s+\d{2}:\d{2}:\d{2})\s+(?<device>\S+)\sCEF:\s\d+\|Fortinet\|Fortigate\|(?<version>[^\|]*)\|(?<sign_id>[^|]*)\|(?<event_name>[^\|]*)\|(?<devid>\d+)\|FTNTFGTlogid=\d{3}[^01]?(?<msgid>\S+)\s+cat=(?<category>\S+)\s+FTNTFGTsubtye=(?<subtye>\S+)\s+(?:FTNTFGTlevel=(?<level>\S+)\s+|FTNTFGTvd=(?<vd>\S+)\s+|src=(?<srci>\S+)\s+|shost=(?<hostname>\S+)\s+|st=(?<srcort>\S+)\s+|deviceInboundInterface=(?<srcintf>\S+)\s+|dst=(?<dsti>\S+)\s+|dt=(?<dstort>\S+)\s+|deviceOutboundInterface=(?<dstintf>\S+)\s+|externalId=(?<external_id>\S+)\s+|roto=(?<roto>\S+)\s+|act=(?<action>\S+)\s+|FTNTFGTolicyid=(?<olicy_id>\S+)\s+|FTNTFGTolicytye=(?<olicy_tye>[^\s]*)\s*|FTNTFGTdstcountry=(?<dst_country>(?:(?!\w+=)\S+\s*)*)\s+|FTNTFGTsrccountry=(?<src_country>\S+)\s+|FTNTFGTtrandis=(?<transdis>\S+)\s+|a=(?<alication_ort>\S+)\s+|FTNTFGTa=(?<alication>(?:(?!\w+=)\S+\s*)*)\s+|FTNTFGTduration=(?<duration>\S+)\s+|out=\S+\s|in=\S+\s+|FTNTFGTsentkt=(?<sent_kt>\S+)\s+|FTNTFGTacat=(?<a_cat>\S+)\s|FTNTFGTcrscore=(?<cr_score>\S+)\s|FTNTFGTcraction=(?<cr_action>\S+)\s|FTNTFGTcrlevel=(?<cr_level>\S+)\s|FTNTFGTdevtye=(?<dev_tye>(?:(?!\w+=)\S+\s*)*)\s+|FTNTFGTosname=(?<os_name>(?:(?!\w+=)\S+\s*)*)\s|FTNTFGTosversion=(?<os_version>\S+)\s|FTNTFGTmastersrcmac=(?<master_src_mac>\S+)\s|FTNTFGTsrcmac=(?<src_mac>\S+)\s|FTNTFGTsrcserver=(?<src_server>\S+)|FTNTFGTeventtye=\S+\s*|FTNTFGToluuid=\S+\s*|dhost=(?<dst_hostname>\S+)\s*|FTNTFGTrofile=\S+\s*|\w+=(?:(?!\w+=)\S+\s*)*\s*)+/
  </parse>
</filter>

<filter my.for19>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^(?<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?<device>\S+)\s+(?:date=\d+\[\d+\]\d+ time=\d+:\d+:\d+\s+|devname="?(?<devname>[^\s"]+)"?\s+|devid="?(?<devid>[^\s"]+)"?\s+|deviceid=\S+\s+)+\s*log_?id=\d{4}(?<msgid>\S+)\s*(?:tye=(?<tye>\S+)|\s+subtye=(?<subtye>\S+)|\s+eventtye=(?<eventtye>\S+)|\s+level=(?<level>\S+)|\s+status=(?<status>\S+)|\s+vd="?(?<vd>[^",\s]+)"?|\s+(?:src_i|srci|src|remi)=(?<srci>\S+)|\s+(?:remort|src_?ort)=(?<srcort>\S+)|\s+(?:outintf|srcintf)="(?<srcintf>[^"]+)"|\s+(?:loci|dst_i|dsti|dst)=(?<dsti>\S+)|\s+(?:locort|dst_?ort)=(?<dstort>\S+)|\s+dstintf="(?<dstintf>[^"]+)"|\s+roto=(?<roto>\S+)|\s+action=(?<action>\S+)|\s+service="(?<service>[^"]+)"|\s+hostname="(?<hostname>[^"]+)"|\s+url="(?<url>[^"]+)"|\s+user="(?<user>[^"]+)"|\s+msg="(?<msg>[^"]+)"|\s+ri=(?<ri>\S+)|\s+[^=]+=(?:"[^"]+"|\S+))+/
  </parse>
</filter>

<filter my.for20>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true

  <parse>
    @type regexp
    expression /^(?<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s+(?<device>\S+).*/
  </parse>
</filter>

<filter my.for100>
  @type parser
  key_name message
  emit_invalid_record_to_error false
  reserve_data true
  <parse>
    @type regexp
    expression /^(?<all>.*)/
  </parse>
</filter>

#################### match to ES ####################

<match my.**>
  @type elasticsearch
  host elasticsearch
  port 9200
  index_name ${tag[1]}
  type_name ${tag[1]}
</match>



